[{"path":"https://earthsystemdiagnostics.github.io/hamstr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Andrew Dolman. Author, maintainer.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dolman (2024). hamstr: Hierarchical Accumulation Modelling Stan R. R package version 0.8.1, https://earthsystemdiagnostics.github.io/hamstr/.","code":"@Manual{,   title = {hamstr: Hierarchical Accumulation Modelling with Stan and R},   author = {Andrew Dolman},   year = {2024},   note = {R package version 0.8.1},   url = {https://earthsystemdiagnostics.github.io/hamstr/}, }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"hamstr-hierarchical-accumulation-modelling-with-stan-and-r-","dir":"","previous_headings":"","what":"Hierarchical Accumulation Modelling with Stan and R","title":"Hierarchical Accumulation Modelling with Stan and R","text":"hamstr implements Bacon-like (Blaauw Christen, 2011) sediment accumulation age-depth model hierarchically structured multi-resolution sediment sections. Bayesian model implemented Stan probabilistic programming language (https://mc-stan.org/).","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical Accumulation Modelling with Stan and R","text":"hamstr can installed directly Github","code":"if (!require(\"remotes\")) {   install.packages(\"remotes\") }  remotes::install_github(\"earthsystemdiagnostics/hamstr\", args = \"--preclean\", build_vignettes = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"using-hamstr","dir":"","previous_headings":"","what":"Using hamstr","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Examples using example core “MSB2K” rbacon package.","code":"library(hamstr) library(rstan)  set.seed(20200827)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"converting-radiocarbon-ages-to-calendar-ages","dir":"","previous_headings":"Using hamstr","what":"Converting radiocarbon ages to calendar ages.","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Unlike Bacon, hamstr conversion radiocarbon dates calendar ages part model fitting process. must done advance. hamstr includes helper function calibrate_14C_age , turn uses function BchronCalibrate Bchron package. Additionally, unlike Bacon, hamstr approximates complex empirical calendar age PDF results calibration single point estimate 1-sigma uncertainty. necessary compromise order able use power Stan platform. Viewed context many uncertainties radiocarbon dates resulting age-models usually major issue. function calibrate_14C_age append columns data.frame calendar ages 1-sigma uncertainties. approximated calendar age PDFs can compared empirical PDFs function compare_14C_PDF sample six dates plotted IntCal20 Marine20 calibrations. approximation much less issue marine radiocarbon dates, cosmogenic radiocarbon signal smoothed mixing ocean.","code":"MSB2K_cal <- calibrate_14C_age(MSB2K, age.14C = \"age\", age.14C.se = \"error\") i <- seq(1, 40, by = floor(40/6))[1:6] compare_14C_PDF(MSB2K$age[i], MSB2K$error[i], cal_curve = \"intcal20\")+   ggplot2::labs(title = \"Intcal20\") compare_14C_PDF(MSB2K$age[i], MSB2K$error[i], cal_curve = \"marine20\") +   ggplot2::labs(title = \"Marine20\")"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"fitting-age-models-with-hamstr","dir":"","previous_headings":"Using hamstr","what":"Fitting age-models with hamstr","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Age-depth (sediment accumulation) models fit function hamstr. Vectors depth, observed age age uncertainty passed arguments hamstr(). default plotting method shows fitted age models together diagnostic plots: traceplot log-posterior assess convergence overall model; plot accumulation rate depth hierarchical level; prior posterior memory parameter(s). default age-models summarised show mean, median, 68% 95% posterior intervals (equivalent 1- 2-sigma uncertainty). data shown points 1- 2-sigma uncertainties. structure sections shown tick marks along top age-model plot.  “spaghetti” plot can created instead shaded regions. shows random sample iterations posterior distribution (realisations age-depth model). can slow lots iterations plotted, default plot 1000 iterations. Additionally, plotting diagnostic plots can switched .","code":"hamstr_fit_1 <- hamstr(depth = MSB2K_cal$depth,                        obs_age = MSB2K_cal$age.14C.cal,                        obs_err = MSB2K_cal$age.14C.cal.se,                         # the seed argument for the sampler is set here so that                        # this example always returns the same numerical result                        # you should not normally do this                         stan_sampler_args = list(seed = 1)) plot(hamstr_fit_1) #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. plot(hamstr_fit_1, summarise = FALSE, plot_diagnostics = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"mean-accumulation-rate","dir":"","previous_headings":"Using hamstr > Fitting age-models with hamstr","what":"Mean accumulation rate","title":"Hierarchical Accumulation Modelling with Stan and R","text":"need specify prior value mean accumulation rate (parameter acc.mean Bacon) hamstr, overall mean accumulation rate full parameter estimated data. default, hamstr uses robust linear regression (MASS::rlm) estimate mean accumulation rate data, uses parametrise prior distribution overall mean accumulation rate. prior half-normal zero mean standard deviation equal 10 times estimated mean. Although introduce slight element “double-dipping”, using data twice (prior likelihood), resulting prior weakly-informative. advantage approach prior automatically scaled appropriately regardless units depth age. prior can checked visually posterior. posterior distribution much narrower weakly informative prior.","code":"plot(hamstr_fit_1, type = \"acc_mean_prior_post\")"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"other-hyperparameters","dir":"","previous_headings":"Using hamstr > Fitting age-models with hamstr","what":"Other hyperparameters","title":"Hierarchical Accumulation Modelling with Stan and R","text":"acc_shape, shape gamma distributed prior accumulation rates default value 4 acc_shape = 4. memory mean mem_mean = 0.5 memory strength mem_strength = 10, Bacon >= 2.5.1.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"setting-the-number-and-hierarchical-structure-of-the-discrete-sections","dir":"","previous_headings":"Using hamstr","what":"Setting the number and hierarchical structure of the discrete sections","title":"Hierarchical Accumulation Modelling with Stan and R","text":"One critical tuning parameters Bacon model parameter thick, determines thickness number discrete -core sediment sections modelled. Finding good optimal value given core often critical getting good age-depth model. sections resulting age-model “blocky” can miss changes sedimentation rate; however, counter-intuitively, many thin sections can also often result age-model “-fits” data - straight line age-control points lower resolution model shows variation accumulation rate. key structural difference Bacon hamstr models hamstr sediment core modelled multiple resolutions simultaneously - removing need trade-smoothness flexibility. resolutions hierarchical structure whereby coarse resolution “parent” sections act priors higher resolution “child” sections. hamstr version 0.8.0 onwards, parameter K_fine controls number discrete sections highest resolution level, K_factor controls much thicker discrete sections subsequent level. Sufficient levels modelled coarsest level just one section - overall mean accumulation rate. structure hierarchical sense modelled accumulation rates parent sections act priors child sections; specifically, estimated accumulation rate coarse parent section acts mean gamma prior child sections. turn, overall mean accumulation rate whole core parameter estimated fitting process. hierarchical structure increasing resolution allows model adapt low-frequency changes accumulation rate, changes “regimes” high low accumulation persist long periods. default, number sections highest resolution (K_fine) set sections approximately unit thickness, .e. depths cm, sections 1 cm thick. applies maximum 900 sections default remains 900 sections coarser resolution used. can changed default via parameter K_fine. K_factor set total number modelled sections approximately 1.2 times K_fine, K_factor^K_factor ≈\\approxK_tot ≈\\approx1.2 * K_fine given shape parameter acc_shape, increasing number modelled hierarchical levels increases total variance accumulation rates highest / finest resolution level. hamstr version 0.5.0 onwards, total variance controlled modifying shape parameter according number hierarchical levels.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"getting-the-fitted-age-models","dir":"","previous_headings":"Using hamstr","what":"Getting the fitted age models","title":"Hierarchical Accumulation Modelling with Stan and R","text":"fitted age models can obtained predict summary methods. iter iteration sampler, “realisation” age model. summary returns age model summarised realisations. hierarchical structure sections makes difficult specify exact depth resolution want resulting age-depth model. predict method takes additional argument depth interpolate specific set depths. function returns NA depths outside modelled depths. interpolated age models can summarised function original fitted objects, n_eff Rhat information lost.","code":"predict(hamstr_fit_1) #> # A tibble: 396,000 × 3 #>     iter depth   age #>    <int> <dbl> <dbl> #>  1     1   1.5 4546. #>  2     1   2.5 4553. #>  3     1   3.5 4561. #>  4     1   4.5 4570. #>  5     1   5.5 4579. #>  6     1   6.5 4588. #>  7     1   7.5 4597. #>  8     1   8.5 4609. #>  9     1   9.5 4624. #> 10     1  10.5 4641. #> # ℹ 395,990 more rows summary(hamstr_fit_1) #> # A tibble: 99 × 15 #>    depth   idx par         mean se_mean    sd `2.5%` `15.9%` `25%` `50%` `75%` #>    <dbl> <dbl> <chr>      <dbl>   <dbl> <dbl>  <dbl>   <dbl> <dbl> <dbl> <dbl> #>  1   1.5     1 c_ages[1]  4461.   1.48   65.6  4316.   4398. 4422. 4466. 4505. #>  2   2.5     2 c_ages[2]  4477.   1.37   61.4  4343.   4419. 4440. 4482. 4520. #>  3   3.5     3 c_ages[3]  4494.   1.26   57.8  4370.   4438. 4459. 4497. 4533. #>  4   4.5     4 c_ages[4]  4511.   1.17   54.7  4394.   4459. 4477. 4515. 4548. #>  5   5.5     5 c_ages[5]  4528.   1.07   52.1  4416.   4477. 4495. 4531. 4563. #>  6   6.5     6 c_ages[6]  4544.   0.980  49.6  4439.   4496. 4514. 4547. 4579. #>  7   7.5     7 c_ages[7]  4561.   0.894  47.4  4461.   4514. 4532. 4563. 4593. #>  8   8.5     8 c_ages[8]  4578.   0.820  45.8  4484.   4531. 4549. 4579. 4609. #>  9   9.5     9 c_ages[9]  4595.   0.760  44.3  4505.   4550. 4567. 4597. 4625. #> 10  10.5    10 c_ages[10] 4615.   0.715  42.7  4528.   4572. 4587. 4616. 4643. #> # ℹ 89 more rows #> # ℹ 4 more variables: `84.1%` <dbl>, `97.5%` <dbl>, n_eff <dbl>, Rhat <dbl> age.mods.interp <- predict(hamstr_fit_1, depth = seq(0, 100, by = 1)) summary(age.mods.interp) #> # A tibble: 101 × 10 #>    depth  mean    sd `2.5%` `15.9%` `25%` `50%` `75%` `84.1%` `97.5%` #>    <dbl> <dbl> <dbl>  <dbl>   <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl> #>  1     0  NaN   NA      NA      NA    NA    NA    NA      NA      NA  #>  2     1  NaN   NA      NA      NA    NA    NA    NA      NA      NA  #>  3     2 4469.  63.4  4328.   4408. 4432. 4474. 4512.   4531.   4581. #>  4     3 4486.  59.5  4355.   4429. 4449. 4490. 4527.   4545.   4591. #>  5     4 4503.  56.2  4382.   4449. 4468. 4506. 4541.   4558.   4603. #>  6     5 4519.  53.3  4406.   4468. 4486. 4523. 4555.   4571.   4614. #>  7     6 4536.  50.8  4428.   4487. 4504. 4539. 4571.   4586.   4627. #>  8     7 4553.  48.4  4450.   4505. 4522. 4555. 4586.   4600.   4641. #>  9     8 4569.  46.5  4475.   4523. 4540. 4571. 4601.   4615.   4655. #> 10     9 4586.  45.0  4496.   4541. 4558. 4588. 4617.   4631.   4669. #> # ℹ 91 more rows"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"getting-and-plotting-the-accumulation-rate","dir":"","previous_headings":"Using hamstr","what":"Getting and plotting the accumulation rate","title":"Hierarchical Accumulation Modelling with Stan and R","text":"-core accumulation rates returned plotted depth-per-time, time-per-depth units. input data years cm units cm/kyr yrs/cm respectively. Note acc_mean parameter hamstr Bacon parametrised terms time per depth.","code":"plot(hamstr_fit_1, type = \"acc_rates\") #> Joining with `by = join_by(idx)` #> Joining with `by = join_by(depth)` summary(hamstr_fit_1, type = \"acc_rates\")  #> Joining with `by = join_by(idx)` #> # A tibble: 196 × 15 #>    depth c_depth_top c_depth_bottom acc_rate_unit   idx   tau  mean    sd `2.5%` #>    <dbl>       <dbl>          <dbl> <chr>         <dbl> <dbl> <dbl> <dbl>  <dbl> #>  1   1.5         1.5            2.5 depth_per_ti…     1     0  75.7  40.6   28.3 #>  2   2.5         2.5            3.5 depth_per_ti…     2     0  72.6  36.1   29.1 #>  3   3.5         3.5            4.5 depth_per_ti…     3     0  71.4  34.1   28.9 #>  4   4.5         4.5            5.5 depth_per_ti…     4     0  69.2  29.0   31.4 #>  5   5.5         5.5            6.5 depth_per_ti…     5     0  68.8  27.3   32.2 #>  6   6.5         6.5            7.5 depth_per_ti…     6     0  69.4  28.3   32.4 #>  7   7.5         7.5            8.5 depth_per_ti…     7     0  69.7  29.2   31.6 #>  8   8.5         8.5            9.5 depth_per_ti…     8     0  62.3  20.5   32.6 #>  9   9.5         9.5           10.5 depth_per_ti…     9     0  55.8  16.5   31.0 #> 10  10.5        10.5           11.5 depth_per_ti…    10     0  53.8  16.1   29.2 #> # ℹ 186 more rows #> # ℹ 6 more variables: `15.9%` <dbl>, `25%` <dbl>, `50%` <dbl>, `75%` <dbl>, #> #   `84.1%` <dbl>, `97.5%` <dbl>"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"diagnostic-plots","dir":"","previous_headings":"Using hamstr","what":"Diagnostic plots","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Additional diagnostic plots available. See ?plot.hamstr_fit options.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"plot-modelled-accumulation-rates-at-each-hierarchical-level","dir":"","previous_headings":"Using hamstr > Diagnostic plots","what":"Plot modelled accumulation rates at each hierarchical level","title":"Hierarchical Accumulation Modelling with Stan and R","text":"","code":"plot(hamstr_fit_1, type = \"hier_acc\")"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"plot-memory-prior-and-posterior","dir":"","previous_headings":"Using hamstr > Diagnostic plots","what":"Plot memory prior and posterior","title":"Hierarchical Accumulation Modelling with Stan and R","text":"example highest resolution sections approximately 1 cm thick, much difference R w.","code":"plot(hamstr_fit_1, type = \"mem\")"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"other-rstan-functions","dir":"","previous_headings":"Using hamstr","what":"Other rstan functions","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Within hamstr_fit object rstan object standard rstan functions operate correctly. example:  first alpha parameter overall mean accumulation rate.","code":"rstan::check_divergences(hamstr_fit_1$fit) #> 0 of 4000 iterations ended with a divergence.  rstan::stan_rhat(hamstr_fit_1$fit) #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. rstan::traceplot(hamstr_fit_1$fit, par = c(\"alpha[1]\"),                  inc_warmup = TRUE)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/index.html","id":"references","dir":"","previous_headings":"Using hamstr","what":"References","title":"Hierarchical Accumulation Modelling with Stan and R","text":"Blaauw, Maarten, J. Andrés Christen. 2011. Flexible Paleoclimate Age-Depth Models Using Autoregressive Gamma Process. Bayesian Analysis 6 (3): 457-74. doi:10.1214/ba/1339616472. Parnell, Andrew. 2016. Bchron: Radiocarbon Dating, Age-Depth Modelling, Relative Sea Level Rate Estimation, Non-Parametric Phase Modelling. R package version 4.2.6. https://CRAN.R-project.org/package=Bchron Stan Development Team (2020). RStan: R interface Stan. R package version 2.21.2. http://mc-stan.org/.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetBrksHalfOffset.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Overlapping Breaks Structure — GetBrksHalfOffset","title":"Get Overlapping Breaks Structure — GetBrksHalfOffset","text":"Get Overlapping Breaks Structure","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetBrksHalfOffset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Overlapping Breaks Structure — GetBrksHalfOffset","text":"","code":"GetBrksHalfOffset(K_fine, K_factor)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetBrksHalfOffset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Overlapping Breaks Structure — GetBrksHalfOffset","text":"K_fine number sections highest resolution model. K_factor rate thickness sections grows subsequent levels.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetIndices.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Indices Structure For Hamstr Model from a Set of Breaks — GetIndices","title":"Get Indices Structure For Hamstr Model from a Set of Breaks — GetIndices","text":"Get Indices Structure Hamstr Model Set Breaks","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetIndices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Indices Structure For Hamstr Model from a Set of Breaks — GetIndices","text":"","code":"GetIndices(nK = NULL, brks = NULL)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetIndices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Indices Structure For Hamstr Model from a Set of Breaks — GetIndices","text":"nK List number breaks level brks List breakpoints level","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetWts.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Weights for Parent Sections — GetWts","title":"Get Weights for Parent Sections — GetWts","text":"Get Weights Parent Sections","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetWts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Weights for Parent Sections — GetWts","text":"","code":"GetWts(a, b)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/GetWts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Weights for Parent Sections — GetWts","text":"Parent breaks b Child breaks","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/MSB2K.html","id":null,"dir":"Reference","previous_headings":"","what":"MSB2K — MSB2K","title":"MSB2K — MSB2K","text":"Dataset core MSB2K provided package rbacon","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/MSB2K.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MSB2K — MSB2K","text":"","code":"MSB2K"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/MSB2K.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MSB2K — MSB2K","text":"data frame 40 rows 4 variables: labID factor Sample ID number lab. age integer Radiocarbon age. error integer Age uncertainty years. depth double Depth core cm.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/MSB2K.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MSB2K — MSB2K","text":"example dataset MSB2K provided rbacon package.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/MSB2K.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MSB2K — MSB2K","text":"Blaauw, Maarten, J. Andrés Christen. 2011. Flexible Paleoclimate Age-Depth Models Using Autoregressive Gamma Process. Bayesian Analysis 6 (3): 457-74. doi:10.1214/ba/1339616472 Maarten Blaauw, J. Andres Christen Marco . Aquino L. (2020). rbacon: Age-Depth Modelling using Bayesian Statistics. R package version 2.4.3. https://CRAN.R-project.org/package=rbacon","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"Summarise Empirical Probability Distribution Function.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"","code":"SummariseEmpiricalPDF(x, p)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"x vector values empirical PDF p vector probabilities","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"Returns named vector mean, median, mode, standard deviation empirical PDF","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"Calculation mode naive. multimodal distribution highest returned, case 2 modes exactly probability, first returned.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/SummariseEmpiricalPDF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise an Empirical Probability Distribution Function. — SummariseEmpiricalPDF","text":"","code":"if (FALSE) { # \\dontrun{ df <- data.frame(x = 1:10) df$p <- dnorm(df$x, 5, 2) hamstr:::SummariseEmpiricalPDF(df$x, df$p)  x <- 1:100 y <- dnorm(x, 50, 10) plot(x, y) SummariseEmpiricalPDF(x, y)   x2 <- x[c(1:50, seq(51, 70, 3), seq(71, 100, 1))] y2 <- y[x2]  plot(x2, y2) SummariseEmpiricalPDF(x2, y2) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_datapoints.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Age Control Points to Plot — add_datapoints","title":"Add Age Control Points to Plot — add_datapoints","text":"Add Age Control Points Plot","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_datapoints.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Age Control Points to Plot — add_datapoints","text":"","code":"add_datapoints(gg, dat)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_datapoints.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Age Control Points to Plot — add_datapoints","text":"gg ggplot2 object dat dataframe containing datapoints add","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_datapoints.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Age Control Points to Plot — add_datapoints","text":"modifies ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_subdivisions.html","id":null,"dir":"Reference","previous_headings":"","what":"Add subdivision tickmarks — add_subdivisions","title":"Add subdivision tickmarks — add_subdivisions","text":"Add subdivision tickmarks","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_subdivisions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add subdivision tickmarks — add_subdivisions","text":"","code":"add_subdivisions(gg, hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_subdivisions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add subdivision tickmarks — add_subdivisions","text":"gg ggplot2 object hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/add_subdivisions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add subdivision tickmarks — add_subdivisions","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"Calibrates set 14C ages using BchronCalibrate optionally summarises empirical PDFs calendar age mean standard deviation appends input dataframe","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"","code":"calibrate_14C_age(   dat,   age.14C = \"age.14C\",   age.14C.se = \"age.14C.se\",   cal_curve = \"intcal20\",   offset = \"offset\",   offset.se = \"offset.se\",   return.type = \"dat\",   dfs = NULL )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"dat dataframe containing radiocarbon dates uncertainties age.14C Name column 14C ages, Default: 'age.14C' age.14C.se Name column 1se 14C age uncertainty, Default: 'age.14C.se' cal_curve Calibration curve, Default: 'intcal13', see BchronCalibrate offset Name offset column, e.g. reservoir age. column exist, offset applied. offset.se Name offset uncertainty column, e.g. sigmaDelatR. column exist, offset uncertainty applied. return.type Return ammended dataframe additionally list PDFs, Default: 'dat' dfs Degrees--freedom values t-distribution associated calibration calculation. large value indicates Gaussian distributions assumed 14C ages","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"dataframe list","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"wrapper Bchron::BchronCalibrate","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/calibrate_14C_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate Radiocarbon Dates with Bchron::BchronCalibrate — calibrate_14C_age","text":"","code":"# With defaults dat <- data.frame(age.14C = c(2000, 20000),                   age.14C.se = c(100, 200)) calibrate_14C_age(dat) #>   age.14C age.14C.se offset offset.se age.14C.cal age.14C.cal.se #> 1    2000        100      0         0        1939       136.2612 #> 2   20000        200      0         0       24047       242.5671  # Change the calibration calibrate_14C_age(dat, cal_curve = \"marine13\") #>   age.14C age.14C.se offset offset.se age.14C.cal age.14C.cal.se #> 1    2000        100      0         0        1564       119.6210 #> 2   20000        200      0         0       23596       257.5961  # Return the PDFs cal.lst <- calibrate_14C_age(dat, cal_curve = \"marine13\", return = \"list\") with(cal.lst[[2]][[1]][[1]], {plot(ageGrid, densities)})   # Use different column names dat <- data.frame(radiocarbon.age = c(2000, 20000),                  se = c(100, 200)) calibrate_14C_age(dat, age.14C = \"radiocarbon.age\", age.14C.se = \"se\") #>   radiocarbon.age  se offset offset.se age.14C.cal age.14C.cal.se #> 1            2000 100      0         0        1939       136.2612 #> 2           20000 200      0         0       24047       242.5671 if (FALSE) { # \\dontrun{ if(interactive()){  #EXAMPLE1  } } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/compare_14C_PDF.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","title":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","text":"Compare full empirical calendar age PDFs calibrated radiocarbon dates t-distribution approximations use hamstr","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/compare_14C_PDF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","text":"","code":"compare_14C_PDF(   age.14C,   age.14C.se,   offset = 0,   offset.se = 0,   cal_curve = \"intcal20\",   nu = 6,   return.type = c(\"plot\", \"list\"),   dfs = rep(100, length(age.14C)) )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/compare_14C_PDF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","text":"age.14C vector radiocarbon dates years BP age.14C.se vector radiocarbon date uncertainties offset vector offsets, e.g. reservoir ages. offset.se vector offset uncertainties, e.g. sigmaDelatR. cal_curve calibration curve nu degrees freedom t-distribution approximation, default hamstr 6 return.type return ggplot object list containing ggplot object two data frames empirical t-distributions dfs Degrees--freedom values t-distribution associated calibration calculation. large value indicates Gaussian distributions assumed 14C ages","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/compare_14C_PDF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","text":"ggplot2 object list data ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/compare_14C_PDF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Empirical and t-distribution Approximated Calendar Age PDFs — compare_14C_PDF","text":"","code":"compare_14C_PDF(age.14C = c(1000, 4000), age.14C.se = c(100, 150),  cal_curve = \"intcal20\", return.type = \"plot\")"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/filter_hamstr_acc_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth accumulation rates — filter_hamstr_acc_rates","title":"Smooth accumulation rates — filter_hamstr_acc_rates","text":"Smooth accumulation rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/filter_hamstr_acc_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth accumulation rates — filter_hamstr_acc_rates","text":"","code":"filter_hamstr_acc_rates(hamstr_acc_rates, tau = 0, kern = c(\"U\", \"G\", \"BH\"))"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/filter_hamstr_acc_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth accumulation rates — filter_hamstr_acc_rates","text":"hamstr_acc_rates accumulation rates get_posterior_acc_rates tau scale smoothing kernel depth units. tau > 0, accumulation rates smoothed (filtered) summary statistics calculated, accumulation rate given depth corresponds average rate depth interval tau. Default 0. kern choice smoothin kernal. U uniform (moving average), G Gaussian, BH Berger Heath (exponential). Defaults U","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/filter_hamstr_acc_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth accumulation rates — filter_hamstr_acc_rates","text":"tibble","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/gamma_sigma_shape.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","title":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","text":"Convert parametrisations gamma distribution","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/gamma_sigma_shape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","text":"","code":"gamma_sigma_shape(mean = NULL, mode = NULL, sigma = NULL, shape = NULL)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/gamma_sigma_shape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","text":"mean Mean gamma distribution mode Mode gamma distribution sigma Standard deviation gamma distribution shape Shape gamma distribution","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/gamma_sigma_shape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","text":"list","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/gamma_sigma_shape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert between parametrisations of the gamma distribution — gamma_sigma_shape","text":"","code":"if (FALSE) { # \\dontrun{ gamma_sigma_shape(mean = 10, sigma = 2) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_K_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Default K_factor — get_K_factor","title":"Get Default K_factor — get_K_factor","text":"Get Default K_factor","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_K_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Default K_factor — get_K_factor","text":"","code":"get_K_factor(K_fine)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_K_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Default K_factor — get_K_factor","text":"K_fine number sections highest resolution","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_inits_hamstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Random Initial Values for the hamstr Stan Model — get_inits_hamstr","title":"Create Random Initial Values for the hamstr Stan Model — get_inits_hamstr","text":"Create Random Initial Values hamstr Stan Model","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_inits_hamstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Random Initial Values for the hamstr Stan Model — get_inits_hamstr","text":"","code":"get_inits_hamstr(stan_dat)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_inits_hamstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Random Initial Values for the hamstr Stan Model — get_inits_hamstr","text":"stan_dat stan data hamstr model","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_inits_hamstr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Random Initial Values for the hamstr Stan Model — get_inits_hamstr","text":"list lists","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_obs_age_err.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — get_obs_age_err","title":"Title — get_obs_age_err","text":"Title","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_obs_age_err.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — get_obs_age_err","text":"","code":"get_obs_age_err(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_obs_age_err.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — get_obs_age_err","text":"hamstr_fit","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_obs_age_err.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — get_obs_age_err","text":"dataframe","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_par_idx.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Stan Parameter Index — get_par_idx","title":"Extract Stan Parameter Index — get_par_idx","text":"Extract Stan Parameter Index","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_par_idx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Stan Parameter Index — get_par_idx","text":"","code":"get_par_idx(x)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_par_idx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Stan Parameter Index — get_par_idx","text":"x vector stan parameter names","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_par_idx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Stan Parameter Index — get_par_idx","text":"vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_acc_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Posterior Accumulation Rates — get_posterior_acc_rates","title":"Get Posterior Accumulation Rates — get_posterior_acc_rates","text":"Get Posterior Accumulation Rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_acc_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Posterior Accumulation Rates — get_posterior_acc_rates","text":"","code":"get_posterior_acc_rates(hamstr_fit, tau = 0, kern = c(\"U\", \"G\", \"BH\"))"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_acc_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Posterior Accumulation Rates — get_posterior_acc_rates","text":"hamstr_fit object returned stan_hamstr. tau scale smoothing kernel depth units. tau > 0, accumulation rates smoothed (filtered) summary statistics calculated, accumulation rate given depth corresponds average rate depth interval tau. Default 0. kern choice smoothin kernal. U uniform (moving average), G Gaussian, BH Berger Heath (exponential). Defaults U","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_acc_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Posterior Accumulation Rates — get_posterior_acc_rates","text":"dataframe/tibble posterior ages iterations warmup","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_acc_rates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Posterior Accumulation Rates — get_posterior_acc_rates","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  get_posterior_acc_rates(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_ages.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Posterior Age Models — get_posterior_ages","title":"Get Posterior Age Models — get_posterior_ages","text":"Get Posterior Age Models","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_ages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Posterior Age Models — get_posterior_ages","text":"","code":"get_posterior_ages(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_ages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Posterior Age Models — get_posterior_ages","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_ages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Posterior Age Models — get_posterior_ages","text":"dataframe/tibble posterior ages iterations warmup","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_posterior_ages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Posterior Age Models — get_posterior_ages","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  get_posterior_ages(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_smooth_i.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Indices For Smoothing Accumulation Rates When Estimating L — get_smooth_i","title":"Get Indices For Smoothing Accumulation Rates When Estimating L — get_smooth_i","text":"Get Indices Smoothing Accumulation Rates Estimating L","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_smooth_i.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Indices For Smoothing Accumulation Rates When Estimating L — get_smooth_i","text":"","code":"get_smooth_i(d, w)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_smooth_i.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Indices For Smoothing Accumulation Rates When Estimating L — get_smooth_i","text":"d  w","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_stan_sampler_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","title":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","text":"Returns list parameters Stan sampler","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_stan_sampler_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","text":"","code":"get_stan_sampler_args(   chains = 4,   cores = chains,   iter = 2000,   warmup = floor(iter/2),   thin = 1,   seed = sample.int(.Machine$integer.max, 1),   check_data = TRUE,   sample_file = NULL,   diagnostic_file = NULL,   verbose = FALSE,   algorithm = c(\"NUTS\", \"HMC\", \"Fixed_param\"),   control = NULL,   include = TRUE,   open_progress = interactive() && !isatty(stdout()) && !identical(Sys.getenv(\"RSTUDIO\"),     \"1\"),   show_messages = TRUE,   ... )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_stan_sampler_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","text":"chains positive integer specifying number Markov chains.     default 4. cores Number cores use executing chains parallel,     defaults 1 recommend setting mc.cores option     many processors hardware RAM allow (    number chains). iter positive integer specifying number iterations     chain (including warmup). default 2000. warmup positive integer specifying number warmup (aka burnin)     iterations per chain. step-size adaptation (default),     also controls number iterations adaptation run (    hence warmup samples used inference). number     warmup iterations smaller iter default     iter/2. thin positive integer specifying period saving samples.     default 1, usually recommended value. seed seed random number generation. default generated     1 maximum integer supported R machine. Even     multiple chains used, one seed needed, chains     seeds derived first chain avoid dependent samples.     seed specified number, .integer applied .     .integer produces NA, seed generated randomly.     seed can also specified character string digits,     \"12345\", converted integer. check_data Logical, defaulting TRUE. TRUE     data preprocessed; otherwise .     See Passing data Stan section stan. sample_file optional character string providing name file.     specified draws parameters saved quantities     written file. provided, files created.     folder specified writable, tempdir() used.     multiple chains, underscore chain number appended     file name prior .csv extension. diagnostic_file optional character string providing name file.     specified diagnostics data parameters written     file. provided, files created. folder specified     writable, tempdir() used. multiple chains,     underscore chain number appended file name prior     .csv extension. verbose TRUE FALSE: flag indicating whether     print intermediate output Stan console, might     helpful model debugging. algorithm One sampling algorithms implemented Stan.     Current options \"NUTS\" (-U-Turn sampler, Hoffman Gelman 2011, Betancourt 2017),     \"HMC\" (static HMC), \"Fixed_param\". default     preferred algorithm \"NUTS\". control named list parameters control sampler's     behavior. See details documentation control argument     stan. include Logical scalar defaulting TRUE indicating     whether include exclude parameters given     pars argument. FALSE, entire multidimensional     parameters can excluded, rather particular elements . open_progress Logical scalar takes effect     cores > 1 recommended TRUE interactive     use progress chains redirected file     automatically opened inspection. short runs,     user might prefer FALSE. show_messages Either logical scalar (defaulting TRUE)     indicating whether print summary Informational Messages     screen chain finished character string naming path     summary stored. Setting FALSE recommended     unless sure model correct numerical     error. ... Additional arguments can chain_id, init_r,     test_grad, append_samples, refresh,     enable_random_init. See documentation stan.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_stan_sampler_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","text":"named list","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/get_stan_sampler_args.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default Parameters for Sampling Hamstr Models with Stan — get_stan_sampler_args","text":"","code":"get_stan_sampler_args() #> $chains #> [1] 4 #>  #> $cores #> [1] 4 #>  #> $iter #> [1] 2000 #>  #> $warmup #> [1] 1000 #>  #> $thin #> [1] 1 #>  #> $seed #> [1] 346871191 #>  #> $check_data #> [1] TRUE #>  #> $sample_file #> NULL #>  #> $diagnostic_file #> NULL #>  #> $verbose #> [1] FALSE #>  #> $algorithm #> [1] \"NUTS\"        \"HMC\"         \"Fixed_param\" #>  #> $control #> NULL #>  #> $include #> [1] TRUE #>  #> $open_progress #> [1] FALSE #>  #> $show_messages #> [1] TRUE #>"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"The 'hamstr' package. — hamstr-package","title":"The 'hamstr' package. — hamstr-package","text":"hamstr implements \"Bacon-like\" Bayesian sediment accumulation age-depth model hierarchically structured multi-resolution discrete sediment sections. Bayesian model implemented Stan probabilistic programming language https://mc-stan.org/. \"Blaauw, Maarten, J. Andrés Christen. 2011. 'Flexible Paleoclimate Age-Depth Models Using Autoregressive Gamma Process.'  Bayesian Analysis 6 (3): 457-74. doi:10.1214/ba/1339616472","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The 'hamstr' package. — hamstr-package","text":"Stan Development Team (2019). RStan: R interface Stan. R package version 2.19.2. https://mc-stan.org","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The 'hamstr' package. — hamstr-package","text":"Maintainer: Andrew Dolman andrew.dolman@awi.de","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a hamstr Age-Depth Model — hamstr","title":"Fit a hamstr Age-Depth Model — hamstr","text":"hamstr used fit age-depth model set age-control points. Ages already desired scale, e.g. calendar ages, calibrated. function calibrate_14C_age can used calibrate radiocarbon dates prior fitting hamstr model.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a hamstr Age-Depth Model — hamstr","text":"","code":"hamstr(   depth,   obs_age,   obs_err,   min_age = 1950 - as.numeric(format(Sys.Date(), \"%Y\")),   K_fine = NULL,   K_factor = NULL,   K,   top_depth = NULL,   bottom_depth = NULL,   acc_mean_prior = NULL,   acc_shape = 4,   mem_mean = 0.5,   mem_strength = 10,   model_bioturbation = FALSE,   n_ind = NULL,   L_prior_mean = 7.5,   L_prior_shape = 2.5,   L_prior_sigma = NULL,   model_displacement = FALSE,   D_prior_mean = 2,   D_prior_shape = 1.5,   D_prior_sigma = NULL,   model_hiatus = FALSE,   H_top = NULL,   H_bottom = NULL,   H_max = NULL,   sample_posterior = TRUE,   hamstr_control = list(),   stan_sampler_args = list() )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a hamstr Age-Depth Model — hamstr","text":"depth depths observed ages (age control points) obs_age observed age depth (age control points) obs_err error associated observed age (1 standard error) min_age minimum age first modelled depth can . Useful extrapolating shallowest age control point e.g. surface. set min_age year core collected. E.g. core collected 1990, ages years BP -40 (present = 1950 convention). default value current year calendar age BP (e.g. -71 2021). K_fine number sections highest resolution model. K_factor rate thickness sections grows subsequent levels. K deprecated, use K_fine K_factor instead. top_depth, bottom_depth top bottom depths desired age-depth model. Must encompass range data. Defaults shallowest deepest data points. acc_mean_prior hyperparameter prior overall mean accumulation rate record. Units obs_age / depth. E.g. depth cm age years accumulation rate years/cm. overall mean accumulation rate given weak half-normal prior mean = 0, SD = 10 * acc_mean_prior. left blank, acc_mean_prior set mean accumulation rate estimated fitting robust linear model using rlm. acc_shape hyperparameter shape priors accumulation rates. Defaults 4. mem_mean hyperparameter; parameter Beta prior distribution \"memory\", .e. autocorrelation parameter underlying AR1 model. prior correlation layers scaled according thickness sediment sections highest resolution hierarchical layer, delta_c, determined total length age-models parameter vector K. mem_mean sets mean value R (defaults 0.5), w = R^(delta_c) mem_strength hyperparameter: sets strength memory prior, defaults 10 Bacon >= 2.5.1 model_bioturbation defaults FALSE. TRUE, additional uncertainty observed ages due sediment mixing (bioturbation) modelled via latent variable process. amount additional uncertainty function mixing depth L, sedimentation rate, number particles (e.g. individual foraminifera) per measured date. See description details. n_ind number individual particles (e.g. foraminifera) sample dated e.g. radiocarbon dating. can single value vector length obs_age. used model_bioturbation = TRUE. L_prior_mean mean gamma prior mixing depth, defaults 7.5. L_prior_shape, L_prior_sigma shape standard deviation gamma prior mixing depth. Set one , calculated. Defaults shape = 2.5. either shape sigma parameter set zero, mixing depth fixed value L_prior_mean, rather sampled. model_displacement model additional error observed ages scale number individual particles sample, example due incomplete mixing. D_prior_mean mean gamma prior additional error observed ages. Units depth variable, e.g. cm. D_prior_shape, D_prior_sigma shape standard deviation gamma prior additional error observed ages. Set one , calculated. Defaults shape = 1.5. either shape sigma parameter set zero, additional error fixed value D_prior_mean, rather sampled. model_hiatus optionally model hiatus. H_top, H_bottom limits location hiatus. default set top bottom data points can set user H_max maximum length hiatus age units sample_posterior set FALSE, hamstr skips sampling model returns data, model structure prior parameters data prior distributions can plotted checked prior running model. Defaults TRUE hamstr_control additional arguments hamstr useful debugging development. See hamstr_control details. stan_sampler_args additional arguments sampling passed named list. e.g. list(chains = 8, iter = 4000) run 8 MCMC chains 4000 iterations instead default 4 chains 2000 iterations. See get_stan_sampler_args details.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a hamstr Age-Depth Model — hamstr","text":"Returns object class \"hamstr_fit\", list composed output stan sampler .$fit, list data passed sampler, .$data","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a hamstr Age-Depth Model — hamstr","text":"","code":"if (FALSE) { # \\dontrun{  fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot(fit)  } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a List of hamstr Control Arguments — hamstr_control","title":"Return a List of hamstr Control Arguments — hamstr_control","text":"Returns list arguments pass hamstr_control may useful debugging development","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a List of hamstr Control Arguments — hamstr_control","text":"","code":"hamstr_control(   scale_R = TRUE,   nu = 6,   scale_shape = TRUE,   smooth_s = FALSE,   inflate_errors = FALSE,   infl_sigma_sd = NULL,   infl_shape_shape = 1,   infl_shape_mean = 1 )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a List of hamstr Control Arguments — hamstr_control","text":"scale_R logical: Scale AR1 coefficient delta_c (Bacon) . Defaults TRUE. nu degrees freedom Student-t distributed error model. Defaults 6, equivalent default parametrisation t.=3, t.b=4 Bacon 2.2. Set high number approximate Gaussian error model, (nu = 100 ). scale_shape scale shape parameter according number hierarchical levels, control total variance alpha innovations. defaults TRUE hamstr verion 0.5. smooth_s smooth sedimentation rate used calculate additional error bioturbation taking mean across nearby sections inflate_errors logical: set TRUE, observation errors inflated data consistent gamma AR1 age-depth model. experimental feature active development. Defaults FALSE. infl_sigma_sd hyperparameter: sets standard deviation half-normal prior mean additional error terms. Defaults 10 times mean observation error obs_err. infl_shape_shape, infl_shape_mean hyperparameters: parametrises gamma prior shape distribution additional error terms. Default 1, 1.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a List of hamstr Control Arguments — hamstr_control","text":"named list","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hamstr_control.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a List of hamstr Control Arguments — hamstr_control","text":"","code":"hamstr_control() #> $scale_R #> [1] TRUE #>  #> $nu #> [1] 6 #>  #> $scale_shape #> [1] TRUE #>  #> $smooth_s #> [1] FALSE #>  #> $inflate_errors #> [1] FALSE #>  #> $infl_sigma_sd #> NULL #>  #> $infl_shape_shape #> [1] 1 #>  #> $infl_shape_mean #> [1] 1 #>"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hierarchical_depths.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculated depth of section boundary at all hierarchical levels — hierarchical_depths","title":"Calculated depth of section boundary at all hierarchical levels — hierarchical_depths","text":"Calculated depth section boundary hierarchical levels","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hierarchical_depths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculated depth of section boundary at all hierarchical levels — hierarchical_depths","text":"","code":"hierarchical_depths(stan_dat)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hierarchical_depths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculated depth of section boundary at all hierarchical levels — hierarchical_depths","text":"stan_dat","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/hierarchical_depths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculated depth of section boundary at all hierarchical levels — hierarchical_depths","text":"list boundaries modelled sections","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/interpolate_age_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","title":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","text":"Interpolate Posterior Age Model New Depths","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/interpolate_age_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","text":"","code":"interpolate_age_models(hamstr_fit, depth)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/interpolate_age_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","text":"hamstr_fit object returned stan_hamstr. depth vector depths interpolate age models. left NULL, depths age control points used.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/interpolate_age_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","text":"hamstr_interpolated_ages object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/interpolate_age_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate Posterior Age Model At New Depths — interpolate_age_models","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  interpolate.age.models(fit, depth = seq(1000, 15000, by = 1000)) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/make_stan_dat_hamstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Make the data object required by the Stan sampler — make_stan_dat_hamstr","title":"Make the data object required by the Stan sampler — make_stan_dat_hamstr","text":"Make data object required Stan sampler","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/make_stan_dat_hamstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make the data object required by the Stan sampler — make_stan_dat_hamstr","text":"","code":"make_stan_dat_hamstr(...)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/make_stan_dat_hamstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make the data object required by the Stan sampler — make_stan_dat_hamstr","text":"... Arguments passed hamstr","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/make_stan_dat_hamstr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make the data object required by the Stan sampler — make_stan_dat_hamstr","text":"list data parameters passed data Stan sampler","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot.hamstr_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot hamstr Objects — plot.hamstr_fit","title":"Plot hamstr Objects — plot.hamstr_fit","text":"plot method class \"hamstr_fit\".","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot.hamstr_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot hamstr Objects — plot.hamstr_fit","text":"","code":"# S3 method for class 'hamstr_fit' plot(   x,   type = c(\"default\", \"age_models\", \"acc_rates\", \"hier_acc_rates\", \"acc_mean_prior_post\",     \"mem_prior_post\", \"L_prior_post\", \"D_prior_post\", \"PDF_14C\"),   summarise = TRUE,   ... )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot.hamstr_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot hamstr Objects — plot.hamstr_fit","text":"x hamstr_fit object type one \"default\", \"age_models\",\"acc_rates\", \"hier_acc_rates\", \"acc_mean_prior_post\", \"mem_prior_post\", \"L_prior_post\", \"D_prior_post\", \"PDF_14C\" summarise logical TRUE FALSE. Plot realisations summarised \"ribbon\" showing 50% 95% intervals (faster), spaghetti plot showing individual realisations. Defaults TRUE (ribbon). ... additional arguments hamstr plotting methods","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot.hamstr_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot hamstr Objects — plot.hamstr_fit","text":"ggplot object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot.hamstr_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot hamstr Objects — plot.hamstr_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot(fit) plot(fit, type = \"acc_rates\", tau = 5, kern = \"U\") } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_acc_mean_prior_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","title":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","text":"Plot Mean Accumulation Rate Prior Posterior Distributions","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_acc_mean_prior_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","text":"","code":"plot_acc_mean_prior_posterior(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_acc_mean_prior_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_acc_mean_prior_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_acc_mean_prior_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Mean Accumulation Rate Prior and Posterior Distributions — plot_acc_mean_prior_posterior","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error,   K = c(10, 10), nu = 6,   acc_mean_prior = 20,   mem_mean = 0.5, mem_strength = 10,   inflate_errors = 0)  plot_acc_mean_prior_posterior(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_age_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Age Models as Spaghetti Plot — plot_age_models","title":"Plot Age Models as Spaghetti Plot — plot_age_models","text":"Plot Age Models Spaghetti Plot","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_age_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Age Models as Spaghetti Plot — plot_age_models","text":"","code":"plot_age_models(hamstr_fit, n.iter = 1000)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_age_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Age Models as Spaghetti Plot — plot_age_models","text":"hamstr_fit object returned stan_hamstr. n.iter number iterations model plot, defaults 1000.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_age_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Age Models as Spaghetti Plot — plot_age_models","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_age_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Age Models as Spaghetti Plot — plot_age_models","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot_age_models(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_downcore_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Downcore Summary — plot_downcore_summary","title":"Plot Downcore Summary — plot_downcore_summary","text":"Plot Downcore Summary","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_downcore_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Downcore Summary — plot_downcore_summary","text":"","code":"plot_downcore_summary(ds, axis = c(\"depth\", \"age\"))"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_downcore_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Downcore Summary — plot_downcore_summary","text":"ds downcore summary age accumulation rate axis units x axis, depth age","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_downcore_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Downcore Summary — plot_downcore_summary","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_gamma_prior_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot A Gamma Prior and Posterior — plot_gamma_prior_posterior","title":"Plot A Gamma Prior and Posterior — plot_gamma_prior_posterior","text":"Plot Gamma Prior Posterior","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_gamma_prior_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot A Gamma Prior and Posterior — plot_gamma_prior_posterior","text":"","code":"plot_gamma_prior_posterior(hamstr_fit, par)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_gamma_prior_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot A Gamma Prior and Posterior — plot_gamma_prior_posterior","text":"hamstr_fit object returned stan_hamstr. par parameter plot","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_gamma_prior_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot A Gamma Prior and Posterior — plot_gamma_prior_posterior","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an hamstr_fit object — plot_hamstr","title":"Plot an hamstr_fit object — plot_hamstr","text":"Plots HAMStR modelled age ~ depth relationship together depths, ages, age uncertainties observed data. random sample size n.iter iterations posterior distribution plotted grey lines. observed data plotted points +- 2*se error bars.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an hamstr_fit object — plot_hamstr","text":"","code":"plot_hamstr(   hamstr_fit,   summarise = TRUE,   n.iter = 1000,   plot_diagnostics = TRUE )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an hamstr_fit object — plot_hamstr","text":"hamstr_fit object returned stan_hamstr. summarise logical TRUE FALSE. Plot realisations summarised \"ribbon\" showing 50% 95% intervals (faster), spaghetti plot showing individual realisations. Defaults TRUE (ribbon). n.iter number iterations model plot, defaults 1000. plot_diagnostics logical, include diagnostic plots: traceplot log-posterior, hierarchical accumulations rates, memory parameter. Defaults TRUE.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot an hamstr_fit object — plot_hamstr","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an hamstr_fit object — plot_hamstr","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  # With age models summarised as a ribbon. Faster than spaghetti plots. plot_hamstr(fit)  # With age models as spaghetti plots. Can see individual realisations, but slower to plot. plot_hamstr(fit, summarise = FALSE) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr_acc_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot accumulation rates — plot_hamstr_acc_rates","title":"Plot accumulation rates — plot_hamstr_acc_rates","text":"Plot accumulation rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr_acc_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot accumulation rates — plot_hamstr_acc_rates","text":"","code":"plot_hamstr_acc_rates(   hamstr_fit,   axis = c(\"depth\", \"age\"),   units = c(\"depth_per_time\", \"time_per_depth\"),   tau = 0,   kern = c(\"U\", \"G\", \"BH\"),   ... )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr_acc_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot accumulation rates — plot_hamstr_acc_rates","text":"hamstr_fit object returned stan_hamstr. axis plot accumulation rate depth age units plot accumulation rate depth per time, time per depth () tau scale smoothing kernel depth units. tau > 0, accumulation rates smoothed (filtered) summary statistics calculated, accumulation rate given depth corresponds average rate depth interval tau. Default 0. kern choice smoothin kernal. U uniform (moving average), G Gaussian, BH Berger Heath (exponential). Defaults U","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hamstr_acc_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot accumulation rates — plot_hamstr_acc_rates","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hierarchical_acc_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","title":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","text":"Plot hierarchical accumulation rate parameters","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hierarchical_acc_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","text":"","code":"plot_hierarchical_acc_rate(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hierarchical_acc_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hierarchical_acc_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_hierarchical_acc_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the hierarchical accumulation rate parameters — plot_hierarchical_acc_rate","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot_hierarchical_acc_rate(fit)  plot_hierarchical_acc_rate(hamstr_fit = fit) +  facet_wrap(~lvl) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_infl_prior_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","title":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","text":"Plot Prior Posterior Distributions Inflation Factor Parameters","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_infl_prior_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","text":"","code":"plot_infl_prior_posterior(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_infl_prior_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_infl_prior_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_infl_prior_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the Prior and Posterior Distributions of the Inflation Factor Parameters — plot_infl_prior_posterior","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error,   inflate_errors = 1)  plot_infl_prior_posterior(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_memory_prior_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","title":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","text":"Plot Memory Prior Posterior","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_memory_prior_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","text":"","code":"plot_memory_prior_posterior(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_memory_prior_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_memory_prior_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_memory_prior_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Memory Prior and Posterior — plot_memory_prior_posterior","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot_memory_prior_posterior(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_prior_posterior_hist.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a Prior and Posterior — plot_prior_posterior_hist","title":"Plot a Prior and Posterior — plot_prior_posterior_hist","text":"Plot Prior Posterior","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_prior_posterior_hist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a Prior and Posterior — plot_prior_posterior_hist","text":"","code":"plot_prior_posterior_hist(prior, posterior, bins = 50)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_prior_posterior_hist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a Prior and Posterior — plot_prior_posterior_hist","text":"prior Numerical PDF prior posterior Sample posterior distribution","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_prior_posterior_hist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a Prior and Posterior — plot_prior_posterior_hist","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_summary_age_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Summary of Posterior Age Models — plot_summary_age_models","title":"Plot Summary of Posterior Age Models — plot_summary_age_models","text":"Plot Summary Posterior Age Models","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_summary_age_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Summary of Posterior Age Models — plot_summary_age_models","text":"","code":"plot_summary_age_models(hamstr_fit)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_summary_age_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Summary of Posterior Age Models — plot_summary_age_models","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_summary_age_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Summary of Posterior Age Models — plot_summary_age_models","text":"ggplot2 object","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/plot_summary_age_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Summary of Posterior Age Models — plot_summary_age_models","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  plot_summary_age_models(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/predict.hamstr_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","title":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","text":"predict method class \"hamstr_fit\". Returns posterior age models interpolated arbitrary depths.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/predict.hamstr_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","text":"","code":"# S3 method for class 'hamstr_fit' predict(   object,   type = c(\"age_models\", \"acc_rates\"),   depth = c(\"modelled\", \"data\"),   ... )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/predict.hamstr_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","text":"object hamstr_fit object type age models \"age_models\" accumulation rates \"acc_rates\" depth defaults \"modelled\", returns modelled depths. \"data\" returns age models depths observations, numerical vector specify depths. Accumulation rates returned modelled depths. ... additional arguments hamstr predict methods","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/predict.hamstr_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","text":"tibble hamstr age-depth model realisations","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/predict.hamstr_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate Age Models at Arbitrary Depths — predict.hamstr_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error   )  predict(fit, depth = seq(1, 100, by = 10)) predict(fit, depth = \"data\") predict(fit) predict(fit, type = \"acc_rates\") } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_age_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise Posterior Age Models — summarise_age_models","title":"Summarise Posterior Age Models — summarise_age_models","text":"Extracts summary statistics posterior age models attaches depths","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_age_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise Posterior Age Models — summarise_age_models","text":"","code":"summarise_age_models(   hamstr_fit,   probs = c(0.025, 0.159, 0.25, 0.5, 0.75, 0.841, 0.975) )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_age_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise Posterior Age Models — summarise_age_models","text":"hamstr_fit object returned stan_hamstr.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_age_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise Posterior Age Models — summarise_age_models","text":"data.frame / tibble","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_age_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise Posterior Age Models — summarise_age_models","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error)  summarise_age_models(fit) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_acc_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise accumulation rates — summarise_hamstr_acc_rates","title":"Summarise accumulation rates — summarise_hamstr_acc_rates","text":"Summarise accumulation rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_acc_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise accumulation rates — summarise_hamstr_acc_rates","text":"","code":"summarise_hamstr_acc_rates(   hamstr_fit,   tau = 0,   kern = c(\"U\", \"G\", \"BH\"),   probs = c(0.025, 0.159, 0.25, 0.5, 0.75, 0.841, 0.975) )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_acc_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise accumulation rates — summarise_hamstr_acc_rates","text":"hamstr_fit hamstr_fit object tau scale smoothing kernel depth units. tau > 0, accumulation rates smoothed (filtered) summary statistics calculated, accumulation rate given depth corresponds average rate depth interval tau. Default 0. kern choice smoothin kernal. U uniform (moving average), G Gaussian, BH Berger Heath (exponential). Defaults U","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_acc_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise accumulation rates — summarise_hamstr_acc_rates","text":"tibble containing summarised posterior accumulation rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise Hamstr Parameters — summarise_hamstr_parameters","title":"Summarise Hamstr Parameters — summarise_hamstr_parameters","text":"Summarise Hamstr Parameters","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise Hamstr Parameters — summarise_hamstr_parameters","text":"","code":"summarise_hamstr_parameters(   object,   pars = c(\"alpha[1]\", \"R\", \"w\", \"L\", \"D\", \"H_depth\", \"H_length\"),   probs = c(0.025, 0.159, 0.25, 0.5, 0.75, 0.841, 0.975) )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise Hamstr Parameters — summarise_hamstr_parameters","text":"object hamstr_fit object pars Character vector parameters include probs numeric vector probabilities values     \\([0,1]\\).  (Values 2e-14 outside     range accepted moved nearby endpoint.)","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_hamstr_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise Hamstr Parameters — summarise_hamstr_parameters","text":"tibble summarised posterior hamstr parameters","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_new_ages.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise Interpolated Posterior Age Models — summarise_new_ages","title":"Summarise Interpolated Posterior Age Models — summarise_new_ages","text":"Summarise Interpolated Posterior Age Models","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_new_ages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise Interpolated Posterior Age Models — summarise_new_ages","text":"","code":"summarise_new_ages(   new_ages,   probs = c(0.025, 0.159, 0.25, 0.5, 0.75, 0.841, 0.975) )"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_new_ages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise Interpolated Posterior Age Models — summarise_new_ages","text":"new_ages Object class \"hamstr_interpolated_ages\"","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_new_ages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise Interpolated Posterior Age Models — summarise_new_ages","text":"data.frame / tibble","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_q.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise to Quantiles and Moments — summarise_q","title":"Summarise to Quantiles and Moments — summarise_q","text":"Summarise Quantiles Moments","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise to Quantiles and Moments — summarise_q","text":"","code":"summarise_q(dat, var, probs = c(0.025, 0.159, 0.25, 0.5, 0.75, 0.841, 0.975))"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise to Quantiles and Moments — summarise_q","text":"dat dataframe tibble var variable summarise (unquoted) probs quantiles summarise","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summarise_q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise to Quantiles and Moments — summarise_q","text":"tibble containing summarised posterior","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise hamstr Models — summary.hamstr_fit","title":"Summarise hamstr Models — summary.hamstr_fit","text":"summary method class \"hamstr_fit\"","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise hamstr Models — summary.hamstr_fit","text":"","code":"# S3 method for class 'hamstr_fit' summary(object, type = c(\"age_models\", \"acc_rates\", \"pars\"), ...)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise hamstr Models — summary.hamstr_fit","text":"object hamstr_fit object type age models \"age_models\" accumulation rates \"acc_rates\" ... additional arguments hamstr summary methods","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise hamstr Models — summary.hamstr_fit","text":"tibble","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise hamstr Models — summary.hamstr_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- hamstr(   depth = MSB2K$depth,   obs_age = MSB2K$age,   obs_err = MSB2K$error,   K = c(10, 10))  summary(fit) summary(fit, type = c(\"acc_rates\")) } # }"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_interpolated_ages.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise Age Models That Have Been Interpolated — summary.hamstr_interpolated_ages","title":"Summarise Age Models That Have Been Interpolated — summary.hamstr_interpolated_ages","text":"summary method class \"hamstr_interpolated_ages\"","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_interpolated_ages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise Age Models That Have Been Interpolated — summary.hamstr_interpolated_ages","text":"","code":"# S3 method for class 'hamstr_interpolated_ages' summary(object, ...)"},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_interpolated_ages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise Age Models That Have Been Interpolated — summary.hamstr_interpolated_ages","text":"object hamstr_interpolated_ages object ... additional arguments hamstr summary methods","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/reference/summary.hamstr_interpolated_ages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise Age Models That Have Been Interpolated — summary.hamstr_interpolated_ages","text":"tibble containing summarised posterior","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-081","dir":"Changelog","previous_headings":"","what":"hamstr 0.8.1","title":"hamstr 0.8.1","text":"Default prior value acc_shape changed 4 light calibration tests Default values prior bioturbation ‘L’ changed following analyis Solan et al. 2019 data. L_prior_mean = 7.5, L_prior_shape = 2.5 Update stan code reflect new array syntax Allow flat structure setting K_factor > K_fine Allow t-dist degrees freedom passed argument BchronCalibrate calibrate_14C_age compare_14C_PDF Change prior ‘D’ half-normal Gamma shape = 1.5, mean = 2 Displacement / depth uncertainty now hierarchically modelled Add ability put maximum length hiatus (age units) - increases stability Changes plotting colours","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-080","dir":"Changelog","previous_headings":"","what":"hamstr 0.8.0","title":"hamstr 0.8.0","text":"Hierarchical structure sections changed child sections offset parents. eventually break backwards compatibility, now old argument “K” used, “K_fine” calculated “K”. change improves age models reducing influence positions breaks low resolution layers.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-072","dir":"Changelog","previous_headings":"","what":"hamstr 0.7.2","title":"hamstr 0.7.2","text":"1 sigma quantiles now included summaries calibration function can handle offset uncertainties (e.g. reservoir age uncertainty) Hamstr logo added Readme","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-071","dir":"Changelog","previous_headings":"","what":"hamstr 0.7.1","title":"hamstr 0.7.1","text":"patchwork used instead ggpubr reduce dependencies","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-070","dir":"Changelog","previous_headings":"","what":"hamstr 0.7.0","title":"hamstr 0.7.0","text":"little used arguments moved hamstr_control stan_sampler_args simplify main function default K structure changed powers 2","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-062","dir":"Changelog","previous_headings":"","what":"hamstr 0.6.2","title":"hamstr 0.6.2","text":"ability model hiatuses reimplemented","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-061","dir":"Changelog","previous_headings":"","what":"hamstr 0.6.1","title":"hamstr 0.6.1","text":"Smoothing accumulation rates plots output","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-060","dir":"Changelog","previous_headings":"","what":"hamstr 0.6.0","title":"hamstr 0.6.0","text":"Ability added model age-heterogeneity bioturbation effect age models. Default plot changed put diagnostic plots bottom.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-052","dir":"Changelog","previous_headings":"","what":"hamstr 0.5.2","title":"hamstr 0.5.2","text":"Minor change way acc_shape adjusted account number hierarchical levels. acc_shape now adjusted control shape gamma distributed alpha parameters, total variance. difference minor. New methods extract plot accumulation rates","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-051","dir":"Changelog","previous_headings":"","what":"hamstr 0.5.1","title":"hamstr 0.5.1","text":"New default hierarchical structure K based default resolution 1 cm (1000 cm) number levels approximately equal number new child sections per parent per level.","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-050","dir":"Changelog","previous_headings":"","what":"hamstr 0.5.0","title":"hamstr 0.5.0","text":"Significant update behaviour using hierarchical structure. acc_shape parameter now adjusted control total variance alpha parameters multiple levels Default mem_mean mem_strength values updated 0.5 10 match updated defaults bacon 2.5.1 onwards","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-041","dir":"Changelog","previous_headings":"","what":"hamstr 0.4.1","title":"hamstr 0.4.1","text":"Methods written generic functions plot summary","code":""},{"path":"https://earthsystemdiagnostics.github.io/hamstr/news/index.html","id":"hamstr-04","dir":"Changelog","previous_headings":"","what":"hamstr 0.4","title":"hamstr 0.4","text":"Package main function renamed hamstr (hierarchical accumulation models Stan R) dev branch hierarchical sections merged master","code":""}]
